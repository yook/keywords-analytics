(function(){"use strict";var X=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function se(N){return N&&N.__esModule&&Object.prototype.hasOwnProperty.call(N,"default")?N.default:N}function ie(N){if(N.__esModule)return N;var _=N.default;if(typeof _=="function"){var p=function w(){return this instanceof w?Reflect.construct(_,arguments,this.constructor):_.apply(this,arguments)};p.prototype=_.prototype}else p={};return Object.defineProperty(p,"__esModule",{value:!0}),Object.keys(N).forEach(function(w){var v=Object.getOwnPropertyDescriptor(N,w);Object.defineProperty(p,w,v.get?v:{enumerable:!0,get:function(){return N[w]}})}),p}function ne(N){throw new Error('Could not dynamically require "'+N+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ee={exports:{}};function ae(N,_,p){return typeof _=="function"?{encoding:null,callback:_}:{encoding:_&&typeof _=="object"?_.encoding:null,callback:p}}function oe(N,_,p){const w=ae(N,_,p),v=w.callback;if(typeof v!="function")throw new Error("fs.readFile callback is required in browser shim");fetch(N).then(M=>{if(!M.ok)throw new Error(`Failed to fetch ${N}: ${M.status}`);return w.encoding==="utf8"||w.encoding==="utf-8"?M.text().then(O=>({text:O,buffer:null})):M.arrayBuffer().then(O=>({buffer:O,text:null}))}).then(({text:M,buffer:O})=>{if(M!==null){v(null,M);return}if(O!==null){const t=new Uint8Array(O);v(null,t);return}v(new Error("Unsupported response type from fetch"))}).catch(M=>v(M))}var le=Object.freeze({__proto__:null,readFile:oe}),ue=ie(le);(function(N,_){(function(p,w){N.exports=w()})(X,function(){if(typeof ne<"u")var p=ue;var w={load:function(v,M,O){if(p){p.readFile(v,{encoding:M=="json"?"utf8":null},function(D,E){if(D){O(D);return}if(M=="json")O(null,JSON.parse(E));else if(M=="arraybuffer")if(E.buffer)O(null,E.buffer);else{for(var u=new ArrayBuffer(E.length),h=new Uint8Array(u),R=0;R<E.length;++R)h[R]=E[R];O(null,u)}else O(new Error("Unknown responseType"))});return}var t=new XMLHttpRequest;t.open("GET",v,!0),t.responseType=M,t.onload=function(D){t.response&&O&&O(null,t.response)},t.send(null)},extend:function(){for(var v={},M=0;M<arguments.length;M++)for(var O in arguments[M])v[O]=arguments[M][O];return v}};return w}),function(p,w){(N.exports=N.exports||{})&&(N.exports.DAWG=w(N.exports))}(X,function(p){var w=0,v=-1,M=4294967295,O=256,t=512,D=1<<31,E={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,10:10,11:11,12:12,13:13,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:21,22:22,23:23,24:24,25:25,26:26,27:27,28:28,29:29,30:30,31:31,32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:92,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:126,127:127,1027:129,8225:135,1046:198,8222:132,1047:199,1168:165,1048:200,1113:154,1049:201,1045:197,1050:202,1028:170,160:160,1040:192,1051:203,164:164,166:166,167:167,169:169,171:171,172:172,173:173,174:174,1053:205,176:176,177:177,1114:156,181:181,182:182,183:183,8221:148,187:187,1029:189,1056:208,1057:209,1058:210,8364:136,1112:188,1115:158,1059:211,1060:212,1030:178,1061:213,1062:214,1063:215,1116:157,1064:216,1065:217,1031:175,1066:218,1067:219,1068:220,1069:221,1070:222,1032:163,8226:149,1071:223,1072:224,8482:153,1073:225,8240:137,1118:162,1074:226,1110:179,8230:133,1075:227,1033:138,1076:228,1077:229,8211:150,1078:230,1119:159,1079:231,1042:194,1080:232,1034:140,1025:168,1081:233,1082:234,8212:151,1083:235,1169:180,1084:236,1052:204,1085:237,1035:142,1086:238,1087:239,1088:240,1089:241,1090:242,1036:141,1041:193,1091:243,1092:244,8224:134,1093:245,8470:185,1094:246,1054:206,1095:247,1096:248,8249:139,1097:249,1098:250,1044:196,1099:251,1111:191,1055:207,1100:252,1038:161,8220:147,1101:253,8250:155,1102:254,8216:145,1103:255,1043:195,1105:184,1039:143,1026:128,1106:144,8218:130,1107:131,8217:146,1108:186,1109:190},u={};for(var h in E)u[E[h]]=String.fromCharCode(h),delete u[0],delete u[1];var R={й:"ёцыф",ц:"йфыву",у:"цывак",к:"увапе",е:"капрн",н:"епрог",г:"нролш",ш:"голдщ",щ:"шлджз",з:"щджэх-",х:"зжэъ-",ъ:"хэ-ё",ф:"йцычяё",ы:"йцувсчяф",в:"цукамсчы",а:"укепимсв",п:"кенртима",р:"енгоьтип",о:"нгшлбьтр",л:"гшщдюбьо",д:"шщзжюбл",ж:"щзхэюд",э:"зхъжё",ё:"йфяъэ",я:"ёфыч",ч:"яфывс",с:"чывам",м:"свапи",и:"мапрт",т:"ипроь",ь:"тролб",б:"ьолдю",ю:"блдж",1:"ёйц",2:"йцу",3:"цук",4:"уке",5:"кен",6:"енг",7:"нгш",8:"гшщ",9:"шщз",0:"щзх-","-":"зхъ","=":"-хъ","\\":"ъэ",".":"южэ"};function f(a){return a>>10<<((a&t)>>6)&M}function r(a){return a&(D|255)&M}function F(a){return(a&O&M)!=0}function y(a){return a&~D&M}var C=function(a,s,e){this.units=a,this.guide=s,this.format=e};return C.fromArrayBuffer=function(a,s){var e=new DataView(a),P=e.getUint32(0,!0),U=e.getUint32(P*4+4,!0);return new C(new Uint32Array(a,4,P),new Uint8Array(a,P*4+8,U*2),s)},C.load=function(a,s,e){p.load(a,"arraybuffer",function(P,U){e(P,P?null:C.fromArrayBuffer(U,s))})},C.prototype.followByte=function(a,s){var e=f(this.units[s]),P=(s^e^a&255)&M;return r(this.units[P])!=(a&255)?v:P},C.prototype.followString=function(a,s){s=s||w;for(var e=0;e<a.length;e++){var P=a.charCodeAt(e);if(!(P in E)||(s=this.followByte(E[P],s),s==v))return v}return s},C.prototype.hasValue=function(a){return F(this.units[a])},C.prototype.value=function(a){var s=f(this.units[a]),e=(a^s)&M;return y(this.units[e])},C.prototype.find=function(a){var s=this.followString(a);return s==v||!this.hasValue(s)?v:this.value(s)},C.prototype.iterateAll=function(a){for(var s=[],e=[a],P=[],U=w,c;;){if(a=e[e.length-1],U!=w)if(c=this.guide[a<<1],c){if(a=this.followByte(c,a),a==v)return s;P.push(c),e.push(a)}else do{if(c=this.guide[(a<<1)+1],P.pop(),e.pop(),!e.length)return s;if(a=e[e.length-1],c){if(a=this.followByte(c,a),a==v)return s;P.push(c),e.push(a)}}while(!c);for(;!this.hasValue(a);){var c=this.guide[a<<1];if(a=this.followByte(c,a),a==v)return s;P.push(c),e.push(a)}this.format=="words"?s.push([((P[0]^1)<<6)+(P[1]>>1),((P[2]^1)<<6)+(P[3]>>1)]):this.format=="probs"?s.push([((P[0]^1)<<6)+(P[1]>>1),((P[2]^1)<<6)+(P[3]>>1),((P[4]^1)<<6)+(P[5]>>1)]):s.push(P.slice()),U=a}},C.prototype.findAll=function(a,s,e,P){P=P||0,e=e||0;for(var U=[],c=[["",0,0,0,w]],K,B,x,q,i,o,l;c.length;){if(K=c.pop(),B=K[4],l=K[3],o=K[2],x=K[1],K=K[0],x==a.length){if(o<P&&!l){var L=this.guide[B<<1];do i=this.followByte(L,B),i!=v&&L in u&&c.push([K+u[L],x,o+1,l,i]),L=this.guide[(i<<1)+1];while(i!=v)}if(this.format=="int"){this.hasValue(B)&&U.push([K,this.value(B)]);continue}if((this.format=="words"||this.format=="probs")&&(B=this.followByte(1,B),B==v))continue;U.push([K,this.iterateAll(B),l,o]);continue}if(s&&a[x]in s&&(q=s[a[x]].charCodeAt(0),q in E&&(i=this.followByte(E[q],B),i!=v&&c.push([K+s[a[x]],x+1,o,l,i]))),o<P&&!l){c.push([K,x+1,o+1,l,B]);var L=this.guide[B<<1];do i=this.followByte(L,B),i!=v&&L in u&&c.push([K+u[L],x,o+1,l,i]),L=this.guide[(i<<1)+1];while(i!=v);var I=R[a[x]];if(I)for(var z=0;z<I.length;z++)q=I.charCodeAt(z),q in E&&(i=this.followByte(E[q],B),i!=v&&c.push([K+I[z],x+1,o+1,l,i]));x<a.length-1&&(q=a.charCodeAt(x+1),q in E&&(i=this.followByte(E[q],B),i!=v&&(q=a.charCodeAt(x),q in E&&(i=this.followByte(E[q],i),i!=v&&c.push([K+a[x+1]+a[x],x+2,o+1,l,i])))))}if(q=a.charCodeAt(x),q in E&&(i=this.followByte(E[q],B),i!=v))for(c.push([K+a[x],x+1,o,l,i]);l<e&&!o&&x<a.length-1;){if(a[x]==a[x+1])c.push([K+a[x],x+2,o,l+1,i]),x++;else if(x<a.length-2&&a[x+1]=="-"&&a[x]==a[x+2])c.push([K+a[x],x+3,o,l+1,i]),x+=2;else break;l++}}return U},C}),function(p,w){(N.exports=N.exports||{})&&(N.exports.Morph=w(N.exports))}(X,function(p){var w,v,M=new Array(3),O=["","по","наи"],t,D,E,u,h={ignoreCase:!1,replacements:{е:"ё"},stutter:1/0,typos:0,parsers:["Dictionary?","AbbrName?","AbbrPatronymic","IntNumber","RealNumber","Punctuation","RomanNumber?","Latin","HyphenParticle","HyphenAdverb","HyphenWords","PrefixKnown","PrefixUnknown?","SuffixKnown?","Abbr"],forceParse:!1,normalizeScore:!0},R="АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЭЮЯ",f=["-то","-ка","-таки","-де","-тко","-тка","-с","-ста"],r=["авиа","авто","аква","анти","анти-","антропо","архи","арт","арт-","астро","аудио","аэро","без","бес","био","вело","взаимо","вне","внутри","видео","вице-","вперед","впереди","гекто","гелио","гео","гетеро","гига","гигро","гипер","гипо","гомо","дву","двух","де","дез","дека","деци","дис","до","евро","за","зоо","интер","инфра","квази","квази-","кило","кино","контр","контр-","космо","космо-","крипто","лейб-","лже","лже-","макро","макси","макси-","мало","меж","медиа","медиа-","мега","мета","мета-","метео","метро","микро","милли","мини","мини-","моно","мото","много","мульти","нано","нарко","не","небез","недо","нейро","нео","низко","обер-","обще","одно","около","орто","палео","пан","пара","пента","пере","пиро","поли","полу","после","пост","пост-","порно","пра","пра-","пред","пресс-","противо","противо-","прото","псевдо","псевдо-","радио","разно","ре","ретро","ретро-","само","санти","сверх","сверх-","спец","суб","супер","супер-","супра","теле","тетра","топ-","транс","транс-","ультра","унтер-","штаб-","экзо","эко","эндо","эконом-","экс","экс-","экстра","экстра-","электро","энерго","этно"],F=[4,9],y,C=[],a=!1;function s(i){if("freeze"in Object){var o=Object.getOwnPropertyNames(i);return o.forEach(function(l){var L=i[l];typeof L=="object"&&L!==null&&s(L)}),Object.freeze(i)}}var e=function(i){var o,l=i.split(" ");this.stat=l[0].split(","),this.flex=l[1]?l[1].split(","):[];for(var L=0;L<2;L++)for(var I=this[["stat","flex"][L]],z=0;z<I.length;z++){var j=I[z];for(this[j]=!0;D[j]&&(o=D[j].parent);)this[o]=j,j=o}"POST"in this&&(this.POS=this.POST)};e.prototype.toString=function(){return(this.stat.join(",")+" "+this.flex.join(",")).trim()},e.prototype.matches=function(i,o){if(!o){if(Object.prototype.toString.call(i)==="[object Array]"){for(var l=0;l<i.length;l++)if(!this[i[l]])return!1;return!0}else for(var L in i)if(Object.prototype.toString.call(i[L])==="[object Array]"){if(!i[L].indexOf(this[L]))return!1}else if(i[L]!=this[L])return!1;return!0}i instanceof c&&(i=i.tag);for(var l=0;l<o.length;l++)if(i[o[l]]!=this[o[l]])return!1;return!0},e.prototype.isProductive=function(){return!(this.NUMR||this.NPRO||this.PRED||this.PREP||this.CONJ||this.PRCL||this.INTJ||this.Apro||this.NUMB||this.ROMN||this.LATN||this.PNCT||this.UNKN)},e.prototype.isCapitalized=function(){return this.Name||this.Surn||this.Patr||this.Geox||this.Init};function P(i,o){var l=new e(i);return l.ext=new e(o),s(l)}var U=function(i,o){if(!a)throw new Error("Please call Az.Morph.init() before using this module.");o=o?p.extend(h,o):h;for(var l=[],L=!1,I=0;I<o.parsers.length;I++){var z=o.parsers[I],j=z[z.length-1]!="?";if(z=j?z:z.slice(0,-1),z in U.Parsers){for(var n=U.Parsers[z](i,o),d=0;d<n.length;d++)n[d].parser=z,!n[d].stutterCnt&&!n[d].typosCnt&&(L=!0);if(l=l.concat(n),L&&j)break}else console.warn('Parser "'+z+'" is not found. Skipping')}!l.length&&o.forceParse&&l.push(new c(i.toLocaleLowerCase(),y));for(var g=0,I=0;I<l.length;I++)if(l[I].parser=="Dictionary"){var m=v.findAll(l[I]+":"+l[I].tag);m&&m[0]&&(l[I].score=m[0][1]/1e6*B(l[I].stutterCnt,l[I].typosCnt),g+=l[I].score)}if(o.normalizeScore){if(g>0)for(var I=0;I<l.length;I++)l[I].parser=="Dictionary"&&(l[I].score/=g);g=0;for(var I=0;I<l.length;I++)l[I].parser!="Dictionary"&&(g+=l[I].score);if(g>0)for(var I=0;I<l.length;I++)l[I].parser!="Dictionary"&&(l[I].score/=g)}return l.sort(function(S,A){return A.score-S.score}),l};U.Parsers={};var c=function(i,o,l,L,I){this.word=i,this.tag=o,this.stutterCnt=L||0,this.typosCnt=I||0,this.score=l||0};c.prototype.normalize=function(i){return this.inflect(i?{POS:this.tag.POS}:0)},c.prototype.inflect=function(i,o){return this},c.prototype.pluralize=function(i){return!this.tag.NOUN&&!this.tag.ADJF&&!this.tag.PRTF?this:(typeof i=="number"&&(i=i%100,i%10==0||i%10>4||i>4&&i<21?i="many":i%10==1?i="one":i="few"),this.tag.NOUN&&!this.tag.nomn&&!this.tag.accs?this.inflect([i=="one"?"sing":"plur",this.tag.CAse]):i=="one"?this.inflect(["sing",this.tag.nomn?"nomn":"accs"]):this.tag.NOUN&&i=="few"?this.inflect(["sing","gent"]):(this.tag.ADJF||this.tag.PRTF)&&this.tag.femn&&i=="few"?this.inflect(["plur","nomn"]):this.inflect(["plur","gent"]))},c.prototype.matches=function(i,o){return this.tag.matches(i,o)},c.prototype.toString=function(){return this.word},c.prototype.log=function(){console.group(this.toString()),console.log("Stutter?",this.stutterCnt,"Typos?",this.typosCnt),console.log(this.tag.ext.toString()),console.groupEnd()};function K(i,o,l){var L;if(l.typos=="auto"){L=i.findAll(o,l.replacements,l.stutter,0);for(var I=0;I<F.length&&!L.length&&o.length>F[I];I++)L=i.findAll(o,l.replacements,l.stutter,I+1)}else L=i.findAll(o,l.replacements,l.stutter,l.typos);return L}function B(i,o){return Math.pow(.3,Math.min(i,1)+o)}var x=function(i,o,l,L,I,z,j){this.word=i,this.paradigmIdx=o,this.paradigm=E[o],this.formIdx=l,this.formCnt=this.paradigm.length/3,this.tag=u[this.paradigm[this.formCnt+l]],this.stutterCnt=L||0,this.typosCnt=I||0,this.score=B(this.stutterCnt,this.typosCnt),this.prefix=z||"",this.suffix=j||""};x.prototype=Object.create(c.prototype),x.prototype.constructor=x,x.prototype.base=function(){return this._base?this._base:this._base=this.word.substring(O[this.paradigm[(this.formCnt<<1)+this.formIdx]].length,this.word.length-t[this.paradigm[this.formIdx]].length)},x.prototype.inflect=function(i,o){if(!o&&typeof i=="number")return new x(O[this.paradigm[(this.formCnt<<1)+i]]+this.base()+t[this.paradigm[i]],this.paradigmIdx,i,0,0,this.prefix,this.suffix);for(var l=0;l<this.formCnt;l++)if(u[this.paradigm[this.formCnt+l]].matches(i,o))return new x(O[this.paradigm[(this.formCnt<<1)+l]]+this.base()+t[this.paradigm[l]],this.paradigmIdx,l,0,0,this.prefix,this.suffix);return!1},x.prototype.log=function(){console.group(this.toString()),console.log("Stutter?",this.stutterCnt,"Typos?",this.typosCnt),console.log(O[this.paradigm[(this.formCnt<<1)+this.formIdx]]+"|"+this.base()+"|"+t[this.paradigm[this.formIdx]]),console.log(this.tag.ext.toString());var i=this.normalize();console.log("=> ",i+" ("+i.tag.ext.toString()+")"),i=this.normalize(!0),console.log("=> ",i+" ("+i.tag.ext.toString()+")"),console.groupCollapsed("Все формы: "+this.formCnt);for(var o=0;o<this.formCnt;o++){var l=this.inflect(o);console.log(l+" ("+l.tag.ext.toString()+")")}console.groupEnd(),console.groupEnd()},x.prototype.toString=function(){if(this.prefix){var i=O[this.paradigm[(this.formCnt<<1)+this.formIdx]];return i+this.prefix+this.word.substr(i.length)+this.suffix}else return this.word+this.suffix};var q=function(i,o){this.left=i,this.right=o,this.tag=o.tag,this.score=i.score*o.score*.8,this.stutterCnt=i.stutterCnt+o.stutterCnt,this.typosCnt=i.typosCnt+o.typosCnt,"formCnt"in o&&(this.formCnt=o.formCnt)};return q.prototype=Object.create(c.prototype),q.prototype.constructor=q,q.prototype.inflect=function(i,o){var l,L,L=this.right.inflect(i,o);return!o&&typeof i=="number"?l=this.left.inflect(L.tag,["POST","NMbr","CAse","PErs","TEns"]):l=this.left.inflect(i,o),l&&L?new q(l,L):!1},q.prototype.toString=function(){return this.left.word+"-"+this.right.word},C.push(function(){U.Parsers.Dictionary=function(n,d){var g=!d.ignoreCase&&n.length&&n[0].toLocaleLowerCase()!=n[0]&&n.substr(1).toLocaleUpperCase()!=n.substr(1);n=n.toLocaleLowerCase();for(var m=K(w,n,d),S=[],A=0;A<m.length;A++)for(var b=0;b<m[A][1].length;b++){var T=new x(m[A][0],m[A][1][b][0],m[A][1][b][1],m[A][2],m[A][3]);(d.ignoreCase||!T.tag.isCapitalized()||g)&&S.push(T)}return S};for(var i=[],o=0;o<=2;o++)for(var l=0;l<=5;l++)for(var L=0;L<=1;L++)i.push(P("NOUN,inan,"+["masc","femn","neut"][o]+",Fixd,Abbr "+["sing","plur"][L]+","+["nomn","gent","datv","accs","ablt","loct"][l],"СУЩ,неод,"+["мр","жр","ср"][o]+",0,аббр "+["ед","мн"][L]+","+["им","рд","дт","вн","тв","пр"][l]));U.Parsers.Abbr=function(n,d){if(n.length<2)return[];if(n.indexOf("-")>-1)return[];if(R.indexOf(n[0])>-1&&R.indexOf(n[n.length-1])>-1){for(var g=0,m=0;m<n.length;m++)R.indexOf(n[m])>-1&&g++;if(g<=5){for(var A=[],m=0;m<i.length;m++){var S=new c(n,i[m],.5);A.push(S)}return A}}if(!d.ignoreCase||n.length>5)return[];n=n.toLocaleUpperCase();for(var m=0;m<n.length;m++)if(R.indexOf(n[m])==-1)return[];for(var A=[],m=0;m<i.length;m++){var S=new c(n,i[m],.2);A.push(S)}return A};var I=function(n,d){for(var g=[],m=0;m<=1;m++)for(var S=0;S<=5;S++)g.push(P("NOUN,anim,"+["masc","femn"][m]+",Sgtm,Name,Fixd,Abbr,Init sing,"+["nomn","gent","datv","accs","ablt","loct"][S],"СУЩ,од,"+["мр","жр"][m]+",sg,имя,0,аббр,иниц ед,"+["им","рд","дт","вн","тв","пр"][S]));return function(A,b){if(A.length!=1)return[];if(b.ignoreCase&&(A=A.toLocaleUpperCase()),R.indexOf(A)==-1)return[];for(var T=[],G=0;G<g.length;G++){var W=new c(A,g[G],d);T.push(W)}return T}};U.Parsers.AbbrName=I(!1,.1),U.Parsers.AbbrPatronymic=I(!0,.1);var z=function(n,d,g){return function(m,S){return S.ignoreCase&&(m=m.toLocaleUpperCase()),m.length&&m.match(n)?[new c(m,d)]:[]}};D.NUMB=D.ЧИСЛО=D.ROMN=D.РИМ=D.LATN=D.ЛАТ=D.PNCT=D.ЗПР=D.UNKN=D.НЕИЗВ={parent:"POST"},U.Parsers.IntNumber=z(/^[−-]?[0-9]+$/,P("NUMB,intg","ЧИСЛО,цел")),U.Parsers.RealNumber=z(/^[−-]?([0-9]*[.,][0-9]+)$/,P("NUMB,real","ЧИСЛО,вещ")),U.Parsers.Punctuation=z(/^[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,\-.\/:;<=>?@\[\]^_`{|}~]+$/,P("PNCT","ЗПР")),U.Parsers.RomanNumber=z(/^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$/,P("ROMN","РИМ")),U.Parsers.Latin=z(/[A-Za-z\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u024f]$/,P("LATN","ЛАТ")),U.Parsers.HyphenParticle=function(n,d){n=n.toLocaleLowerCase();for(var g=[],m=0;m<f.length;m++)if(n.substr(n.length-f[m].length)==f[m])for(var S=n.slice(0,-f[m].length),A=K(w,S,d),b=0;b<A.length;b++)for(var T=0;T<A[b][1].length;T++){var G=new x(A[b][0],A[b][1][T][0],A[b][1][T][1],A[b][2],A[b][3],"",f[m]);G.score*=.9,g.push(G)}return g};var j=P("ADVB","Н");U.Parsers.HyphenAdverb=function(n,d){if(n=n.toLocaleLowerCase(),n.length<5||n.substr(0,3)!="по-")return[];for(var g=K(w,n.substr(3),d),m=[],S={},A=0;A<g.length;A++)if(!S[g[A][0]])for(var b=0;b<g[A][1].length;b++){var T=new x(g[A][0],g[A][1][b][0],g[A][1][b][1],g[A][2],g[A][3]);if(T.matches(["ADJF","sing","datv"])){S[g[A][0]]=!0,T=new c("по-"+g[A][0],j,T.score*.9,g[A][2],g[A][3]),m.push(T);break}}return m},U.Parsers.HyphenWords=function(n,d){n=n.toLocaleLowerCase();for(var g=0;g<r.length;g++)if(r[g][r[g].length-1]=="-"&&n.substr(0,r[g].length)==r[g])return[];var m=[],S=n.split("-");if(S.length!=2||!S[0].length||!S[1].length){if(S.length>2)for(var A=S[S.length-1],G=U.Parsers.Dictionary(A,d),b=0;b<G.length;b++)G[b]instanceof x&&(G[b].score*=.2,G[b].prefix=n.substr(0,n.length-A.length-1)+"-",m.push(G[b]));return m}for(var T=U.Parsers.Dictionary(S[0],d),G=U.Parsers.Dictionary(S[1],d),g=0;g<T.length;g++)if(!T[g].tag.Abbr)for(var b=0;b<G.length;b++)T[g].matches(G[b],["POST","NMbr","CAse","PErs","TEns"])&&(T[g].stutterCnt+G[b].stutterCnt>d.stutter||T[g].typosCnt+G[b].typosCnt>d.typos||m.push(new q(T[g],G[b])));for(var b=0;b<G.length;b++)G[b]instanceof x&&(G[b].score*=.3,G[b].prefix=S[0]+"-",m.push(G[b]));return m},U.Parsers.PrefixKnown=function(n,d){var g=!d.ignoreCase&&n.length&&n[0].toLocaleLowerCase()!=n[0]&&n.substr(1).toLocaleUpperCase()!=n.substr(1);n=n.toLocaleLowerCase();for(var m=[],S=0;S<r.length;S++)if(!(n.length-r[S].length<3)&&n.substr(0,r[S].length)==r[S])for(var A=n.substr(r[S].length),b=U.Parsers.Dictionary(A,d),T=0;T<b.length;T++)b[T].tag.isProductive()&&(!d.ignoreCase&&b[T].tag.isCapitalized()&&!g||(b[T].score*=.7,b[T].prefix=r[S],m.push(b[T])));return m},U.Parsers.PrefixUnknown=function(n,d){var g=!d.ignoreCase&&n.length&&n[0].toLocaleLowerCase()!=n[0]&&n.substr(1).toLocaleUpperCase()!=n.substr(1);n=n.toLocaleLowerCase();for(var m=[],S=1;S<=5&&!(n.length-S<3);S++)for(var A=n.substr(S),b=U.Parsers.Dictionary(A,d),T=0;T<b.length;T++)b[T].tag.isProductive()&&(!d.ignoreCase&&b[T].tag.isCapitalized()&&!g||(b[T].score*=.3,b[T].prefix=n.substr(0,S),m.push(b[T])));return m},U.Parsers.SuffixKnown=function(n,d){if(n.length<4)return[];var g=!d.ignoreCase&&n.length&&n[0].toLocaleLowerCase()!=n[0]&&n.substr(1).toLocaleUpperCase()!=n.substr(1);n=n.toLocaleLowerCase();for(var m=[],S=1,A=[0,.2,.3,.4,.5,.6],b={},T=0;T<O.length;T++)if(!(O[T].length&&n.substr(0,O[T].length)!=O[T])){for(var G=n.substr(O[T].length),W=5;W>=S;W--)if(!(W>=G.length)){var de=G.substr(0,G.length-W),we=G.substr(G.length-W),Q=M[T].findAll(we,d.replacements,0,0);if(Q){for(var V=[],k=1,H=0;H<Q.length;H++)for(var Ce=Q[H][0],$=Q[H][1],Y=0;Y<$.length;Y++){var J=new x(O[T]+de+Ce,$[Y][1],$[Y][2]);if(J.tag.isProductive()&&!(!d.ignoreCase&&J.tag.isCapitalized()&&!g)){var re=J.toString()+":"+$[Y][1]+":"+$[Y][2];re in b||(k=Math.max(k,$[Y][0]),J.score=$[Y][0]*A[W],V.push(J),b[re]=!0)}}if(V.length>0){for(var H=0;H<V.length;H++)V[H].score/=k;m=m.concat(V),S=Math.max(W-1,1)}}}}return m},y=P("UNKN","НЕИЗВ")}),U.setDefaults=function(i){h=i},U.init=function(i,o){var l=0,L,I;function z(){if(!--l){u=Array(L.length);for(var n=0;n<L.length;n++)u[n]=new e(L[n]),u[n].ext=new e(I[n]);u=s(u);for(var n=0;n<C.length;n++)C[n]();a=!0,o&&o(null,U)}}!o&&typeof i=="function"&&(o=i,typeof __dirname=="string"?i=__dirname+"/../dicts":i="dicts"),l++,p.DAWG.load(i+"/words.dawg","words",function(n,d){if(n){o(n);return}w=d,z()});for(var j=0;j<3;j++)(function(n){l++,p.DAWG.load(i+"/prediction-suffixes-"+n+".dawg","probs",function(d,g){if(d){o(d);return}M[n]=g,z()})})(j);l++,p.DAWG.load(i+"/p_t_given_w.intdawg","int",function(n,d){if(n){o(n);return}v=d,z()}),l++,p.load(i+"/grammemes.json","json",function(n,d){if(n){o(n);return}D={};for(var g=0;g<d.length;g++)D[d[g][0]]=D[d[g][2]]={parent:d[g][1],internal:d[g][0],external:d[g][2],externalFull:d[g][3]};z()}),l++,p.load(i+"/gramtab-opencorpora-int.json","json",function(n,d){if(n){o(n);return}L=d,z()}),l++,p.load(i+"/gramtab-opencorpora-ext.json","json",function(n,d){if(n){o(n);return}I=d,z()}),l++,p.load(i+"/suffixes.json","json",function(n,d){if(n){o(n);return}t=d,z()}),l++,p.load(i+"/paradigms.array","arraybuffer",function(n,d){if(n){o(n);return}var g=new Uint16Array(d),m=g[0],S=1;E=[];for(var A=0;A<m;A++){var b=g[S++];E.push(g.subarray(S,S+b)),S+=b}z()})},U}),function(p,w){(N.exports=N.exports||{})&&(N.exports.Syntax=w(N.exports))}(X,function(p){var w=function(){};return w}),function(p,w){(N.exports=N.exports||{})&&(N.exports.Tokens=w())}(X,function(){for(var p="ac|ad|ae|aero|af|ag|ai|al|am|ao|aq|ar|arpa|as|asia|at|au|aw|ax|az|ba|bb|be|bf|bg|bh|bi|biz|bj|bm|bo|br|bs|bt|bv|bw|by|bz|ca|cat|cc|cd|cf|cg|ch|ci|cl|cm|cn|co|com|coop|cr|cu|cv|cw|cx|cz|de|dj|dk|dm|do|dz|ec|edu|ee|eg|es|et|eu|fi|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gov|gp|gq|gr|gs|gt|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|info|int|io|iq|ir|is|it|je|jo|jobs|jp|kg|ki|km|kn|kp|kr|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mil|mk|ml|mn|mo|mobi|mp|mq|mr|ms|mt|mu|museum|mv|mw|mx|my|na|name|nc|ne|net|nf|ng|nl|no|nr|nu|nz|om|org|pa|pe|pf|ph|pk|pl|pm|pn|post|pr|pro|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tel|tf|tg|th|tj|tk|tl|tm|tn|to|tr|travel|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|yt|امارات|հայ|বাংলা|бел|中国|中國|الجزائر|مصر|ею|გე|ελ|香港|भारत|بھارت|భారత్|ભારત|ਭਾਰਤ|ভারত|இந்தியா|ایران|ايران|عراق|الاردن|한국|қаз|ලංකා|இலங்கை|المغرب|мкд|мон|澳門|澳门|مليسيا|عمان|پاکستان|پاكستان|فلسطين|срб|рф|قطر|السعودية|السعودیة|السعودیۃ|السعوديه|سودان|新加坡|சிங்கப்பூர்|سورية|سوريا|ไทย|تونس|台灣|台湾|臺灣|укр|اليمن|xxx|zm|aaa|aarp|abarth|abb|abbott|abbvie|abc|able|abogado|abudhabi|academy|accenture|accountant|accountants|aco|active|actor|adac|ads|adult|aeg|aetna|afamilycompany|afl|africa|africamagic|agakhan|agency|aig|aigo|airbus|airforce|airtel|akdn|alfaromeo|alibaba|alipay|allfinanz|allstate|ally|alsace|alstom|americanexpress|americanfamily|amex|amfam|amica|amsterdam|analytics|android|anquan|anz|aol|apartments|app|apple|aquarelle|arab|aramco|archi|army|art|arte|asda|associates|athleta|attorney|auction|audi|audible|audio|auspost|author|auto|autos|avianca|aws|axa|azure|baby|baidu|banamex|bananarepublic|band|bank|bar|barcelona|barclaycard|barclays|barefoot|bargains|baseball|basketball|bauhaus|bayern|bbc|bbt|bbva|bcg|bcn|beats|beauty|beer|bentley|berlin|best|bestbuy|bet|bharti|bible|bid|bike|bing|bingo|bio|black|blackfriday|blanco|blockbuster|blog|bloomberg|blue|bms|bmw|bnl|bnpparibas|boats|boehringer|bofa|bom|bond|boo|book|booking|boots|bosch|bostik|boston|bot|boutique|box|bradesco|bridgestone|broadway|broker|brother|brussels|budapest|bugatti|build|builders|business|buy|buzz|bzh|cab|cafe|cal|call|calvinklein|camera|camp|cancerresearch|canon|capetown|capital|capitalone|car|caravan|cards|care|career|careers|cars|cartier|casa|case|caseih|cash|casino|catering|catholic|cba|cbn|cbre|cbs|ceb|center|ceo|cern|cfa|cfd|chanel|channel|chase|chat|cheap|chintai|chloe|christmas|chrome|chrysler|church|cipriani|circle|cisco|citadel|citi|citic|city|cityeats|claims|cleaning|click|clinic|clinique|clothing|cloud|club|clubmed|coach|codes|coffee|college|cologne|comcast|commbank|community|company|compare|computer|comsec|condos|construction|consulting|contact|contractors|cooking|cookingchannel|cool|corsica|country|coupon|coupons|courses|credit|creditcard|creditunion|cricket|crown|crs|cruise|cruises|csc|cuisinella|cymru|cyou|dabur|dad|dance|date|dating|datsun|day|dclk|dds|deal|dealer|deals|degree|delivery|dell|deloitte|delta|democrat|dental|dentist|desi|design|dev|dhl|diamonds|diet|digital|direct|directory|discount|discover|dish|diy|dnp|docs|dodge|dog|doha|domains|dot|download|drive|dstv|dtv|dubai|duck|dunlop|duns|dupont|durban|dvag|dwg|earth|eat|edeka|education|email|emerck|emerson|energy|engineer|engineering|enterprises|epost|epson|equipment|ericsson|erni|esq|estate|esurance|etisalat|eurovision|eus|events|everbank|exchange|expert|exposed|express|extraspace|fage|fail|fairwinds|faith|family|fan|fans|farm|farmers|fashion|fast|fedex|feedback|ferrari|ferrero|fiat|fidelity|fido|film|final|finance|financial|fire|firestone|firmdale|fish|fishing|fit|fitness|flickr|flights|flir|florist|flowers|flsmidth|fly|foo|foodnetwork|football|ford|forex|forsale|forum|foundation|fox|free|fresenius|frl|frogans|frontdoor|frontier|ftr|fujitsu|fujixerox|fun|fund|furniture|futbol|fyi|gal|gallery|gallo|gallup|game|games|gap|garden|gbiz|gdn|gea|gent|genting|george|ggee|gift|gifts|gives|giving|glade|glass|gle|global|globo|gmail|gmbh|gmo|gmx|godaddy|gold|goldpoint|golf|goo|goodhands|goodyear|goog|google|gop|got|gotv|grainger|graphics|gratis|green|gripe|group|guardian|gucci|guge|guide|guitars|guru|hair|hamburg|hangout|haus|hbo|hdfc|hdfcbank|health|healthcare|help|helsinki|here|hermes|hgtv|hiphop|hisamitsu|hitachi|hiv|hkt|hockey|holdings|holiday|homedepot|homegoods|homes|homesense|honda|honeywell|horse|host|hosting|hot|hoteles|hotmail|house|how|hsbc|htc|hughes|hyatt|hyundai|ibm|icbc|ice|icu|ieee|ifm|iinet|ikano|imamat|imdb|immo|immobilien|industries|infiniti|ing|ink|institute|insurance|insure|intel|international|intuit|investments|ipiranga|irish|iselect|ismaili|ist|istanbul|itau|itv|iveco|iwc|jaguar|java|jcb|jcp|jeep|jetzt|jewelry|jio|jlc|jll|jmp|jnj|joburg|jot|joy|jpmorgan|jprs|juegos|juniper|kaufen|kddi|kerryhotels|kerrylogistics|kerryproperties|kfh|kia|kim|kinder|kindle|kitchen|kiwi|koeln|komatsu|kosher|kpmg|kpn|krd|kred|kuokgroup|kyknet|kyoto|lacaixa|ladbrokes|lamborghini|lamer|lancaster|lancia|lancome|land|landrover|lanxess|lasalle|lat|latino|latrobe|law|lawyer|lds|lease|leclerc|lefrak|legal|lego|lexus|lgbt|liaison|lidl|life|lifeinsurance|lifestyle|lighting|like|lilly|limited|limo|lincoln|linde|link|lipsy|live|living|lixil|loan|loans|locker|locus|loft|lol|london|lotte|lotto|love|lpl|lplfinancial|ltd|ltda|lundbeck|lupin|luxe|luxury|macys|madrid|maif|maison|makeup|man|management|mango|market|marketing|markets|marriott|marshalls|maserati|mattel|mba|mcd|mcdonalds|mckinsey|med|media|meet|melbourne|meme|memorial|men|menu|meo|metlife|miami|microsoft|mini|mint|mit|mitsubishi|mlb|mls|mma|mnet|mobily|moda|moe|moi|mom|monash|money|monster|montblanc|mopar|mormon|mortgage|moscow|moto|motorcycles|mov|movie|movistar|msd|mtn|mtpc|mtr|multichoice|mutual|mutuelle|mzansimagic|nab|nadex|nagoya|naspers|nationwide|natura|navy|nba|nec|netbank|netflix|network|neustar|new|newholland|news|next|nextdirect|nexus|nfl|ngo|nhk|nico|nike|nikon|ninja|nissan|nissay|nokia|northwesternmutual|norton|now|nowruz|nowtv|nra|nrw|ntt|nyc|obi|observer|off|office|okinawa|olayan|olayangroup|oldnavy|ollo|omega|one|ong|onl|online|onyourside|ooo|open|oracle|orange|organic|orientexpress|origins|osaka|otsuka|ott|ovh|page|pamperedchef|panasonic|panerai|paris|pars|partners|parts|party|passagens|pay|payu|pccw|pet|pfizer|pharmacy|philips|photo|photography|photos|physio|piaget|pics|pictet|pictures|pid|pin|ping|pink|pioneer|pizza|place|play|playstation|plumbing|plus|pnc|pohl|poker|politie|porn|pramerica|praxi|press|prime|prod|productions|prof|progressive|promo|properties|property|protection|pru|prudential|pub|pwc|qpon|quebec|quest|qvc|racing|raid|read|realestate|realtor|realty|recipes|red|redstone|redumbrella|rehab|reise|reisen|reit|reliance|ren|rent|rentals|repair|report|republican|rest|restaurant|review|reviews|rexroth|rich|richardli|ricoh|rightathome|ril|rio|rip|rmit|rocher|rocks|rodeo|rogers|room|rsvp|ruhr|run|rwe|ryukyu|saarland|safe|safety|sakura|sale|salon|samsclub|samsung|sandvik|sandvikcoromant|sanofi|sap|sapo|sarl|sas|save|saxo|sbi|sbs|sca|scb|schaeffler|schmidt|scholarships|school|schule|schwarz|science|scjohnson|scor|scot|seat|secure|security|seek|select|sener|services|ses|seven|sew|sex|sexy|sfr|shangrila|sharp|shaw|shell|shia|shiksha|shoes|shopping|shouji|show|showtime|shriram|silk|sina|singles|site|ski|skin|sky|skype|sling|smart|smile|sncf|soccer|social|softbank|software|sohu|solar|solutions|song|sony|soy|space|spiegel|spot|spreadbetting|srl|srt|stada|staples|star|starhub|statebank|statefarm|statoil|stc|stcgroup|stockholm|storage|store|stream|studio|study|style|sucks|supersport|supplies|supply|support|surf|surgery|suzuki|swatch|swiftcover|swiss|sydney|symantec|systems|tab|taipei|talk|taobao|target|tatamotors|tatar|tattoo|tax|taxi|tci|tdk|team|tech|technology|telecity|telefonica|temasek|tennis|teva|thd|theater|theatre|theguardian|tiaa|tickets|tienda|tiffany|tips|tires|tirol|tjmaxx|tjx|tkmaxx|tmall|today|tokyo|tools|top|toray|toshiba|total|tours|town|toyota|toys|trade|trading|training|travelchannel|travelers|travelersinsurance|trust|trv|tube|tui|tunes|tushu|tvs|ubank|ubs|uconnect|unicom|university|uno|uol|ups|vacations|vana|vanguard|vegas|ventures|verisign|versicherung|vet|viajes|video|vig|viking|villas|vin|vip|virgin|visa|vision|vista|vistaprint|viva|vivo|vlaanderen|vodka|volkswagen|volvo|vote|voting|voto|voyage|vuelos|wales|walmart|walter|wang|wanggou|warman|watch|watches|weather|weatherchannel|webcam|weber|website|wed|wedding|weibo|weir|whoswho|wien|wiki|williamhill|win|windows|wine|winners|wme|wolterskluwer|woodside|work|works|world|wow|wtc|wtf|xbox|xerox|xfinity|xihuan|xin|कॉम|セール|佛山|慈善|集团|在线|大众汽车|点看|คอม|八卦|موقع|一号店|公益|公司|香格里拉|网站|移动|我爱你|москва|католик|онлайн|сайт|联通|קום|时尚|微博|淡马锡|ファッション|орг|नेट|ストア|삼성|商标|商店|商城|дети|ポイント|新闻|工行|家電|كوم|中文网|中信|娱乐|谷歌|電訊盈科|购物|クラウド|通販|网店|संगठन|餐厅|网络|ком|诺基亚|食品|飞利浦|手表|手机|ارامكو|العليان|اتصالات|بازار|موبايلي|ابوظبي|كاثوليك|همراه|닷컴|政府|شبكة|بيتك|عرب|机构|组织机构|健康|рус|珠宝|大拿|みんな|グーグル|世界|書籍|网址|닷넷|コム|天主教|游戏|vermögensberater|vermögensberatung|企业|信息|嘉里大酒店|嘉里|广东|政务|xperia|xyz|yachts|yahoo|yamaxun|yandex|yodobashi|yoga|yokohama|you|youtube|yun|zappos|zara|zero|zip|zippo|zone|zuerich".split("|"),w={html:!1,wiki:!1,markdown:!1,hashtags:!0,mentions:!0,emails:!0,links:{protocols:!0,www:!1,tlds:{}}},v={nbsp:" ",quot:'"',gt:">",lt:"<",amp:"&",ndash:"–"},M=0;M<p.length;M++)w.links.tlds[p[M]]=!0;var O=function(u,h,R,f,r,F,y,C){this.source=u,this.st=h,this.length=R,this.index=f,this.firstUpper=r,this.allUpper=F,this.type=y,C&&(this.subType=C)};O.prototype.toString=function(){return"_str"in this&&this._str.length==this.length?this._str:this._str=this.source.substr(this.st,this.length)},O.prototype.indexOf=function(u){if(u.length==1){for(var h=0;h<this.length;h++)if(this.source[this.st+h]==u)return h;return-1}return this.toString().indexOf(u)},O.prototype.toLowerCase=function(){return this.toString().toLocaleLowerCase()},O.prototype.isCapitalized=function(){return this.firstUpper&&!this.allUpper},O.prototype.en=function(){return this.st+this.length-1};var t=function(u,h){if(this instanceof t)this.tokens=[],this.source="",typeof u=="string"?(this.config=h?Az.extend(w,h):w,this.append(u)):this.config=u?Az.extend(w,u):w,this.index=-1;else return new t(u,h)};t.WORD=new String("WORD"),t.NUMBER=new String("NUMBER"),t.OTHER=new String("OTHER"),t.DIGIT=new String("DIGIT"),t.CYRIL=new String("CYRIL"),t.LATIN=new String("LATIN"),t.MIXED=new String("MIXED"),t.PUNCT=new String("PUNCT"),t.SPACE=new String("SPACE"),t.MARKUP=new String("MARKUP"),t.NEWLINE=new String("NEWLINE"),t.EMAIL=new String("EMAIL"),t.LINK=new String("LINK"),t.HASHTAG=new String("HASHTAG"),t.MENTION=new String("MENTION"),t.TAG=new String("TAG"),t.CONTENT=new String("CONTENT"),t.SCRIPT=new String("SCRIPT"),t.STYLE=new String("STYLE"),t.COMMENT=new String("COMMENT"),t.CLOSING=new String("CLOSING"),t.TEMPLATE=new String("TEMPLATE"),t.RANGE=new String("RANGE"),t.ENTITY=new String("ENTITY"),t.prototype.append=function(u,h){h=h?Az.extend(this.config,h):this.config,h.links&&h.links.tlds===!0&&(h.links.tlds=w.links.tlds);var R=this.source.length;this.source+=u;for(var f=this.source,r=this.tokens,F=R;F<f.length;F++){var y=f[F],C=f.charCodeAt(F),a=!1,s=r.length-1,e=r[s],P=F;if(h.html&&y==";")if(s>0&&e.type===t.WORD&&r[s-1].length==1&&f[r[s-1].st]=="&"){var U=e.toLowerCase();U in v&&(y=v[U],C=y.charCodeAt(0),s-=2,e=r[s],r.length=s+1)}else s>1&&(e.type===t.NUMBER||e.type===t.WORD&&f[e.st]=="x")&&r[s-1].length==1&&f[r[s-1].st]=="#"&&r[s-1].length==1&&f[r[s-1].st]=="&"&&(f[e.st]=="x"?C=parseInt(e.toString().substr(1),16):C=parseInt(e.toString(),10),y=String.fromCharCode(C),s-=3,e=r[s],r.length=s+1);var c=t.OTHER,K=y.toLocaleLowerCase()!=y;C>=1024&&C<=1279&&(c=t.CYRIL),(C>=65&&C<=90||C>=97&&C<=122||C>=192&&C<=591)&&(c=t.LATIN),C>=48&&C<=57&&(c=t.DIGIT),(C<=32||C>=128&&C<=160)&&(c=t.SPACE),`‐-−‒–—―.…,:;?!¿¡()[]«»"'’‘’“”/⁄`.indexOf(y)>-1&&(c=t.PUNCT);var B=c,x=!1;c===t.CYRIL||c===t.LATIN?(B=t.WORD,x=c):c===t.DIGIT&&(B=t.NUMBER);var q=!e||f[e.st+e.length-1]==`
`;if(h.wiki&&(q&&":;*#~|".indexOf(y)>-1&&(B=t.MARKUP,x=t.NEWLINE),"={[|]}".indexOf(y)>-1&&(B=t.MARKUP)),h.markdown&&(q&&"=-#>+-".indexOf(y)>-1&&(B=t.MARKUP,x=t.NEWLINE),"[]*~_`\\".indexOf(y)>-1&&(B=t.MARKUP)),e){if(h.wiki&&y!="'"&&e.length==1&&f[e.st]=="'"&&s>0&&r[s-1].type===t.WORD&&r[s-1].subType===t.LATIN&&(r[s-1].length+=e.length,s-=1,r.length=s+1,e=r[s]),h.links&&h.links.tlds&&(c===t.PUNCT||c===t.SPACE)&&r.length>2&&r[s-2].type===t.WORD&&r[s-1].length==1&&f[r[s-1].st]=="."&&r[s].type===t.WORD&&e.toString()in h.links.tlds){for(;s>=2&&r[s-2].type===t.WORD&&r[s-1].length==1&&(f[r[s-1].st]=="."||f[r[s-1].st]=="@"||f[r[s-1].st]==":");)s-=2,e=r[s],e.length+=r[s+1].length+r[s+2].length,e.allUpper=e.allUpper&&r[s+1].allUpper&&r[s+2].allUpper;h.emails&&e.indexOf("@")>-1&&e.indexOf(":")==-1?e.type=t.EMAIL:(e.type=t.LINK,y=="/"&&(a=!0)),r.length=s+1}else if(e.type===t.LINK)y==")"&&s>=1&&r[s-1].type===t.MARKUP&&r[s-1].length==1&&f[r[s-1].st]=="("?B=t.MARKUP:c!==t.SPACE&&y!=","&&y!="<"&&(a=!0);else if(e.type===t.EMAIL)(c===t.CYRIL||c===t.LATIN||y==".")&&(a=!0);else if(e.type===t.HASHTAG||e.type===t.MENTION)(c===t.CYRIL||c==t.LATIN||c==t.DIGIT||y=="_"||y=="@"&&e.indexOf("@")==-1)&&(a=!0);else if(e.type===t.TAG&&(e.quote||f[e.en()]!=">"))a=!0,e.quote?y==e.quote&&f[e.en()]!="\\"&&delete e.quote:(y=='"'||y=="'")&&(e.quote=y);else if(e.type===t.CONTENT)a=!0,e.quote?y==e.quote&&f[e.en()]!="\\"&&delete e.quote:y=='"'||y=="'"?e.quote=y:y==">"&&(e.length>=8&&e.toString().substr(-8)=="<\/script"?(e.length-=8,P-=8,a=!1,B=t.TAG,x=t.CLOSING):e.length>=7&&e.toString().substr(-7)=="</style"&&(e.length-=7,P-=7,a=!1,B=t.TAG,x=t.CLOSING));else if(e.type===t.TAG&&e.type!==t.CLOSING&&e.length>=8&&e.toLowerCase().substr(1,6)=="script")B=t.CONTENT,x=t.SCRIPT;else if(e.type===t.TAG&&e.type!==t.CLOSING&&e.length>=7&&e.toLowerCase().substr(1,5)=="style")B=t.CONTENT,x=t.STYLE;else if(h.html&&e.length==1&&f[e.st]=="<"&&(c===t.LATIN||y=="!"||y=="/"))a=!0,e.type=t.TAG,y=="!"?e.subType=t.COMMENT:y=="/"&&(e.subType=t.CLOSING);else if(e.type===t.CONTENT)a=!0;else if(e.type===t.MARKUP&&e.subType==t.TEMPLATE&&(f[e.en()]!="}"||f[e.en()-1]!="}"))a=!0;else if(e.type===t.MARKUP&&e.type===t.LINK&&f[e.en()]!=")")a=!0;else if(e.type===t.MARKUP&&f[e.st]=="`"&&e.subType===t.NEWLINE&&c===t.LATIN)a=!0;else if(c===t.CYRIL||c===t.LATIN)e.type===t.WORD?(a=!0,e.subType=e.subType==c?e.subType:t.MIXED):e.type===t.NUMBER?(a=!0,e.subType=e.subType&&e.subType!=c?t.MIXED:c):h.hashtags&&e.length==1&&f[e.st]=="#"?(a=!0,e.type=t.HASHTAG):h.mentions&&e.length==1&&f[e.st]=="@"&&(s==0||r[s-1].type===t.SPACE)?(a=!0,e.type=t.MENTION):c===t.LATIN&&e.length==1&&(f[e.st]=="'"||f[e.st]=="’")?(a=!0,e.type=t.WORD,e.subType=t.LATIN):e.length==1&&f[e.st]=="-"&&(a=!0,s>0&&r[s-1].type===t.NUMBER&&(e=r[s-1],e.length+=r[s].length,r.length-=1),e.type=t.WORD,e.subType=c);else if(c===t.DIGIT)e.type===t.WORD?(a=!0,e.subType=t.MIXED):e.type===t.NUMBER?a=!0:e.length==1&&(f[e.st]=="+"||f[e.st]=="-")?(a=!0,s>0&&r[s-1].type===t.NUMBER&&(e=r[s-1],e.length+=r[s].length,e.subType=t.RANGE,r.length-=1),e.type=t.NUMBER):e.length==1&&(f[e.st]==","||f[e.st]==".")&&r.length>1&&r[s-1].type===t.NUMBER&&(a=!0,e=r[s-1],e.length+=r[s].length,r.length-=1);else if(c===t.SPACE)e.type===t.SPACE&&(a=!0);else if(e.type===t.MARKUP&&f[e.st]==y&&"=-~:*#`'>_".indexOf(y)>-1)a=!0;else if(y==".")h.links&&h.links.www&&e.length==3&&e.toLowerCase()=="www"&&(a=!0,e.type=t.LINK);else if(h.wiki&&y=="'"&&f[e.en()]=="'")e.length>1?(e.length--,P--,B=t.MARKUP):(a=!0,e.type=t.MARKUP);else if(y=="-"||e.subType==t.LATIN&&(y=="’"||y=="'"))e.type===t.WORD&&(a=!0);else if(y=="/")h.links&&h.links.protocols&&r.length>2&&r[s-2].type===t.WORD&&r[s-2].subType==t.LATIN&&r[s-1].length==1&&f[r[s-1].st]==":"&&r[s].length==1&&f[r[s].st]=="/"&&(a=!0,e=r[s-2],e.length+=r[s-1].length+r[s].length,e.allUpper=e.allUpper&&r[s-1].allUpper&&r[s].allUpper,e.type=t.LINK,r.length-=2);else if(h.html&&y==";")s>0&&e.type===t.WORD&&r[s-1].length==1&&f[r[s-1].st]=="&"?(a=!0,e=r[s-1],e.length+=r[s].length,e.allUpper=e.allUpper&&r[s-1].allUpper,e.type=t.ENTITY,r.length-=1):s>1&&(e.type===t.WORD||e.type===t.NUMBER)&&r[s-1].length==1&&f[r[s-1].st]=="#"&&r[s-2].length==1&&f[r[s-2].st]=="&"&&(a=!0,e=r[s-2],e.length+=r[s-1].length+r[s].length,e.allUpper=e.allUpper&&r[s-1].allUpper&&r[s].allUpper,e.type=t.ENTITY,r.length-=2);else if(h.markdown&&y=="["&&e.length==1&&f[e.st]=="!")a=!0,e.type=t.MARKUP;else if(h.markdown&&y=="("&&e.length==1&&f[e.st]=="]")B=t.MARKUP,x=t.LINK;else if(h.wiki&&y=="{"&&e.length==1&&f[e.st]=="{")a=!0,e.type=t.MARKUP,e.subType=t.TEMPLATE;else if(h.wiki&&y=="["&&e.length==1&&f[e.st]=="[")a=!0;else if(h.wiki&&y=="]"&&e.length==1&&f[e.st]=="]")a=!0;else if(h.wiki&&y=="|"&&!q){for(var i=-1,o=s-1;o>=0;o--){if(r[o].length==2&&f[r[o].st]=="["&&f[r[o].st+1]=="["){i=o;break}if(r[o].length==1&&f[r[o].st]=="|"||r[o].indexOf(`
`)>-1)break}if(i>-1){a=!0;for(var o=s-1;o>=i;o--)e=r[o],e.length+=r[o+1].length,e.allUpper=e.allUpper&&r[o+1].allUpper;s=i,r.length=s+1,e.subType=t.LINK}}}a?(e.length++,e.allUpper=e.allUpper&&K):(e=new O(f,P,F+1-P,r.length,K,K,B,x),r.push(e))}return this};function D(){return!0}function E(u,h){if(!u)return D();if(typeof u=="function")return u;var R=u,f;if("length"in u){f=!h,R={};for(var r=0;r<u.length;r++)R[u[r]]=!0}else f=h,h=!1;return function(F,y,C){if(F.subType){var a=F.type+"."+F.subType;if(a in R)return R[a]!=h}return F.type in R?R[F.type]!=h:!f}}return t.prototype.done=function(u,h){if(!u)return this.tokens;for(var R=E(u,h),f=[],r=0;r<this.tokens.length;r++)R(this.tokens[r],r,this.tokens)&&f.push(this.tokens[r]);return f},t.prototype.count=function(u,h){if(!u)return this.tokens.length;for(var R=E(u,h),f=0,r=0;r<this.tokens.length;r++)R(this.tokens[r],r,this.tokens)&&f++;return f},t.prototype.nextToken=function(u,h,R){var f=E(h,R),r=this.index;for(r++;r<this.tokens.length&&f(this.tokens[r],r,this.tokens);)r++;return r<this.tokens.length?(u&&(this.index=r),this.tokens[r]):null},t.prototype.punctAhead=function(){var u=this.nextToken(!1,["SPACE"],!0);return u&&u.type=="PUNCT"&&u},t.prototype.prevToken=function(u,h,R){var f=E(h,R),r=this.index;for(r--;r>=0&&f(this.tokens[r],r,this.tokens);)r--;return r>=0?(u&&(this.index=r),this.tokens[r]):null},t.prototype.punctBehind=function(){var u=this.prevToken(!1,["SPACE"],!0);return u&&u.type=="PUNCT"&&u},t.prototype.hasTokensAhead=function(u,h){return this.nextToken(!1,u,h)!=null},t.prototype.hasTokensBehind=function(u,h){return this.prevToken(!1,u,h)!=null},t})})(ee);var fe=ee.exports,te=se(fe);const he="/az-dicts",ce="app-db";let Z=null;function ge(){return Z||(Z=new Promise((N,_)=>{te.Morph.init(he,p=>{if(p){_(p);return}N()})}),Z)}function pe(N){return String(N||"").replace(/[^\n\p{L}\p{N}\s'-]+/gu," ").split(/\s+/).filter(Boolean)}function me(N){if(!N||!N.tag)return[];const _=new Set,p=w=>{if(!w)return;const v=String(w||"").toUpperCase();v&&_.add(v)};return Array.isArray(N.tag.stat)&&N.tag.stat.forEach(p),Array.isArray(N.tag.flex)&&N.tag.flex.forEach(p),Object.entries(N.tag).forEach(([w,v])=>{v===!0?p(w):typeof v=="string"&&p(v)}),Array.from(_)}async function ye(N){if(!N)return null;const _=te.Morph(N);if(!Array.isArray(_)||_.length===0)return null;const p=_[0],w=typeof p.normalize=="function"?p.normalize():p,v=String((w==null?void 0:w.word)||(p==null?void 0:p.word)||N||"").toLowerCase(),M=me(p);return{lemma:v,grammemes:M}}async function ve(N){var w;const _=String(N||"").trim().toLowerCase();if(!_)return{lemma:"",tags:"",grammemes:""};const p=pe(_);try{const v=[],M=new Set;for(const E of p){const u=await ye(E),h=(u==null?void 0:u.lemma)||E;v.push(h),(w=u==null?void 0:u.grammemes)!=null&&w.length&&u.grammemes.forEach(R=>M.add(R))}const O=v.join(" "),t=[...v].sort((E,u)=>E.localeCompare(u,"ru")).join(","),D=[...M].sort((E,u)=>E.localeCompare(u,"ru")).join(",");return{lemma:O,tags:t,grammemes:D}}catch(v){console.warn("[az-morphology.worker] normalizeKeywordText failed for",_,v);const O=[...p.filter(t=>typeof t=="string"&&t)].sort((t,D)=>t.localeCompare(D,"ru")).join(",");return{lemma:_,tags:O,grammemes:""}}}function be(){return new Promise((N,_)=>{const p=indexedDB.open(ce);p.onsuccess=()=>N(p.result),p.onerror=()=>_(p.error),p.onupgradeneeded=()=>{}})}self.addEventListener("message",async N=>{const{type:_,payload:p,requestId:w}=N.data||{};try{if(_!=="morphology")return;await ge();const v=p!=null&&p.projectId?String(p.projectId):"anon",M=p!=null&&p.batchSize?Number(p.batchSize):10,O=await be();if(!O.objectStoreNames.contains("keywords")){self.postMessage({type:"morphology:done",requestId:w,processed:0,total:0});return}let t=0;if(await new Promise((u,h)=>{try{const r=O.transaction("keywords","readonly").objectStore("keywords").openCursor();r.onsuccess=F=>{const y=F.target.result;if(!y)return u();const C=y.value||{};String(C.projectId||"anon")===v&&!C.morphology_processed&&t++,y.continue()},r.onerror=()=>h(r.error)}catch(R){h(R)}}),t===0){self.postMessage({type:"morphology:done",requestId:w,processed:0,total:0});return}let D=0,E=[];await new Promise((u,h)=>{try{const f=O.transaction("keywords","readwrite").objectStore("keywords"),r=f.openCursor();r.onsuccess=async F=>{const y=F.target.result;if(!y){if(E.length>0){for(const s of E)f.put(s);D+=E.length,self.postMessage({type:"morphology:progress",requestId:w,processed:D,total:t}),E=[]}return u()}const C=y.value||{};if(String(C.projectId||"anon")===v&&!C.morphology_processed){try{const{lemma:s,tags:e,grammemes:P}=await ve(C.keyword);C.lemma=s,C.tags=e,P&&(C.grammemes=P),C.morphology_processed=1,E.push(C)}catch{const e=String(C.keyword||"").trim().toLowerCase(),U=[...e.split(/\s+/g).filter(c=>!!c)].sort((c,K)=>c.localeCompare(K,"ru")).join(",");C.lemma=C.lemma||e,C.tags=C.tags||U,C.grammemes=C.grammemes||"",C.morphology_processed=1,E.push(C)}if(E.length>=M){for(const s of E)f.put(s);D+=E.length,self.postMessage({type:"morphology:progress",requestId:w,processed:D,total:t}),E=[]}}y.continue()},r.onerror=()=>h(r.error)}catch(R){h(R)}}),self.postMessage({type:"morphology:done",requestId:w,processed:D||t,total:t})}catch(v){self.postMessage({type:"error",requestId:w,error:String(v)})}})})();
